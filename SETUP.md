# ê°ì • ì”í–¥ ì „ì‹œ POC - Setup Guide

## ğŸ“‹ ì‹œìŠ¤í…œ êµ¬ì„±

ì´ í”„ë¡œì íŠ¸ëŠ” 3ê°€ì§€ ì»´í¬ë„ŒíŠ¸ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤:

1. **API Server** (Dart) - REST API ì„œë²„
2. **Web Dashboard** (Flutter Web) - ë°ì´í„° ì‹œê°í™” ëŒ€ì‹œë³´ë“œ
3. **Mobile App** (Flutter Mobile) - ì¹´ë©”ë¼ ê¸°ë°˜ ì½”ë„ˆ ì¶”ì 

---

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### 1ï¸âƒ£ API Server ì‹¤í–‰

í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ì„œë²„ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤:

```bash
dart run bin/server.dart
```

ë˜ëŠ” íŠ¹ì • í¬íŠ¸ë¡œ ì‹¤í–‰:

```bash
dart run bin/server.dart 8080
```

âœ… ì„œë²„ê°€ ì‹¤í–‰ë˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë¡œê·¸ê°€ í‘œì‹œë©ë‹ˆë‹¤:
```
âœ… API Server running on http://0.0.0.0:8080
```

**ì‚¬ìš© ê°€ëŠ¥í•œ ì—”ë“œí¬ì¸íŠ¸:**
- `POST /api/staytime` - ëª¨ë°”ì¼ì—ì„œ ì‹œê°„ ë°ì´í„° ìˆ˜ì‹ 
- `GET /api/staytime` - ëª¨ë“  ë””ë°”ì´ìŠ¤ ë°ì´í„° ì¡°íšŒ
- `GET /api/staytime/:deviceId` - íŠ¹ì • ë””ë°”ì´ìŠ¤ ë°ì´í„° ì¡°íšŒ
- `GET /health` - ì„œë²„ ìƒíƒœ í™•ì¸

---

### 2ï¸âƒ£ Web Dashboard ì‹¤í–‰

ìƒˆ í„°ë¯¸ë„ ì°½ì—ì„œ:

```bash
flutter run -d chrome
```

ë˜ëŠ” íŠ¹ì • ë¸Œë¼ìš°ì €ë¡œ:

```bash
flutter run -d edge
```

âœ… ëŒ€ì‹œë³´ë“œê°€ ì—´ë¦¬ë©´ 2ì´ˆë§ˆë‹¤ ìë™ìœ¼ë¡œ ë°ì´í„°ë¥¼ ê°±ì‹ í•©ë‹ˆë‹¤.

---

### 3ï¸âƒ£ Mobile App ì‹¤í–‰

**ì¤‘ìš”: ëª¨ë°”ì¼ ì•± ì„¤ì •**

1. `lib/services/api_service.dart` íŒŒì¼ì„ ì—´ê³  `baseUrl`ì„ ìˆ˜ì •í•©ë‹ˆë‹¤:

```dart
ApiService({
  this.baseUrl = 'http://YOUR_COMPUTER_IP:8080',  // <-- ì—¬ê¸° ìˆ˜ì •!
  this.deviceId = 'mobile_01',
});
```

2. ì»´í“¨í„°ì˜ IP ì£¼ì†Œ ì°¾ê¸°:
   - **macOS**: `ifconfig | grep "inet " | grep -v 127.0.0.1`
   - **Windows**: `ipconfig`
   - ì˜ˆ: `192.168.0.10`

3. ëª¨ë°”ì¼ ë””ë°”ì´ìŠ¤ê°€ **ê°™ì€ Wi-Fi ë„¤íŠ¸ì›Œí¬**ì— ì—°ê²°ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸

4. ì•± ì‹¤í–‰:

```bash
# Android
flutter run

# iOS
flutter run -d ios

# ë˜ëŠ” íŠ¹ì • ë””ë°”ì´ìŠ¤ ì„ íƒ
flutter devices
flutter run -d <device-id>
```

---

## ğŸ“± Mobile App ì‚¬ìš©ë²•

### ğŸ¯ í”½ì…€ ê¸°ë°˜ ëª¨ì…˜ ê°ì§€ (ìë™)

ì•±ì€ ê¸°ë³¸ì ìœ¼ë¡œ **ìë™ ëª¨ì…˜ ê°ì§€ ëª¨ë“œ**ë¡œ ì‹œì‘ë©ë‹ˆë‹¤:

1. ì•±ì´ ì‹œì‘ë˜ë©´ ì¹´ë©”ë¼ê°€ ìë™ìœ¼ë¡œ ì´ˆê¸°í™”ë©ë‹ˆë‹¤
2. í™”ë©´ì´ 4ê°œ êµ¬ì—­ìœ¼ë¡œ ë‚˜ë‰˜ì–´ ìˆìŠµë‹ˆë‹¤:
   - Top Left (ì™¼ìª½ ìœ„)
   - Top Right (ì˜¤ë¥¸ìª½ ìœ„)
   - Bottom Left (ì™¼ìª½ ì•„ë˜)
   - Bottom Right (ì˜¤ë¥¸ìª½ ì•„ë˜)

3. ê° ì½”ë„ˆë¥¼ **íƒ­**í•˜ë©´ í•´ë‹¹ ì˜ì—­ì˜ ì‹œê°„ì´ ì¶”ì ë©ë‹ˆë‹¤
4. ë‹¤ë¥¸ ì½”ë„ˆë¥¼ íƒ­í•˜ë©´ ìë™ìœ¼ë¡œ ì „í™˜ë©ë‹ˆë‹¤
5. í•˜ë‹¨ì—ì„œ ì‹¤ì‹œê°„ìœ¼ë¡œ ê° ì½”ë„ˆì˜ ëˆ„ì  ì‹œê°„ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

### ì‘ë™ ë°©ì‹

**í”½ì…€ ê¸°ë°˜ ëª¨ì…˜ ê°ì§€:**
1. ì¹´ë©”ë¼ í”„ë ˆì„ì˜ í”½ì…€ ë³€í™”ë¥¼ ê°ì§€
2. ì´ì „ í”„ë ˆì„ê³¼ ë¹„êµí•˜ì—¬ ì°¨ì´ ê³„ì‚°
3. í™”ë©´ì„ 4ê°œ êµ¬ì—­ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ê° ì˜ì—­ì˜ ëª¨ì…˜ ì¸¡ì •
4. ê°€ì¥ ë§ì´ ì›€ì§ì¸ ì˜ì—­ì„ ìë™ ì¶”ì 
5. í•´ë‹¹ ì½”ë„ˆê°€ **ì´ˆë¡ìƒ‰**ìœ¼ë¡œ í•˜ì´ë¼ì´íŠ¸ë¨

**ì¥ì :**
- âœ… ML Kit ë¶ˆí•„ìš” (ê°€ë²¼ì›€)
- âœ… ëª¨ë“  ë””ë°”ì´ìŠ¤ì—ì„œ ì‘ë™
- âœ… ì˜¤ë¥˜ ì—†ìŒ
- âœ… ë¹ ë¥¸ ì²˜ë¦¬ ì†ë„

### ëª¨ë“œ ì „í™˜

**ìë™ ëª¨ì…˜ ê°ì§€** (ê¸°ë³¸):
- ì›€ì§ì„ì´ ìˆëŠ” ì˜ì—­ì„ ìë™ìœ¼ë¡œ ê°ì§€
- ì´ˆë¡ìƒ‰ìœ¼ë¡œ ì˜ì—­ í•˜ì´ë¼ì´íŠ¸
- ìƒíƒœ í‘œì‹œ: `AUTO` (ì´ˆë¡ìƒ‰)

**ìˆ˜ë™ ëª¨ë“œ**:
- í™”ë©´ì˜ ì½”ë„ˆë¥¼ ì§ì ‘ íƒ­í•˜ì—¬ ì¶”ì 
- ìƒíƒœ í‘œì‹œ: `MANUAL` (ì£¼í™©ìƒ‰)
- ìƒë‹¨ âœ¨ ë²„íŠ¼ìœ¼ë¡œ ì „í™˜

### ë²„íŠ¼ ê¸°ëŠ¥

- **âœ¨/ğŸ‘† Auto/Manual**: ìë™ ê°ì§€ â†” ìˆ˜ë™ ëª¨ë“œ ì „í™˜
- **ğŸ”„ Refresh**: ëª¨ë“  ì‹œê°„ì„ 0ìœ¼ë¡œ ë¦¬ì…‹
- **ğŸ“¤ Send**: ì¦‰ì‹œ ë°ì´í„°ë¥¼ ì„œë²„ë¡œ ì „ì†¡

### ìë™ ë°ì´í„° ì „ì†¡

- **5ì´ˆë§ˆë‹¤** ìë™ìœ¼ë¡œ ì„œë²„ì— ë°ì´í„° ì „ì†¡

---

## ğŸ” í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ì „ì²´ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸

1. **ì„œë²„ ì‹œì‘**
   ```bash
   dart run bin/server.dart
   ```

2. **ì›¹ ëŒ€ì‹œë³´ë“œ ì—´ê¸°** (ìƒˆ í„°ë¯¸ë„)
   ```bash
   flutter run -d chrome
   ```

3. **ëª¨ë°”ì¼ ì•± ì‹¤í–‰** (ìƒˆ í„°ë¯¸ë„)
   ```bash
   flutter run
   ```

4. **í…ŒìŠ¤íŠ¸ ì§„í–‰**
   - Mobile: Top Leftë¥¼ íƒ­í•˜ê³  5ì´ˆ ëŒ€ê¸°
   - Web: Top Left êµ¬ì—­ì˜ ì‹œê°„ì´ ì¦ê°€í•˜ëŠ”ì§€ í™•ì¸
   - Mobile: Top Rightë¥¼ íƒ­í•˜ê³  10ì´ˆ ëŒ€ê¸°
   - Web: Top Right êµ¬ì—­ì˜ ì‹œê°„ì´ ì¦ê°€í•˜ëŠ”ì§€ í™•ì¸

---

## ğŸ› ï¸ ë¬¸ì œ í•´ê²°

### ëª¨ë°”ì¼ì—ì„œ ì„œë²„ì— ì—°ê²° ì•ˆë¨

1. ë°©í™”ë²½ í™•ì¸:
   ```bash
   # macOS ë°©í™”ë²½ ì„¤ì • í™•ì¸
   # System Preferences > Security & Privacy > Firewall
   ```

2. ê°™ì€ Wi-Fi ë„¤íŠ¸ì›Œí¬ í™•ì¸
   - ì»´í“¨í„°ì™€ ëª¨ë°”ì¼ì´ ê°™ì€ ë„¤íŠ¸ì›Œí¬ì— ìˆì–´ì•¼ í•©ë‹ˆë‹¤

3. IP ì£¼ì†Œ í™•ì¸:
   ```bash
   # í˜„ì¬ IP í™•ì¸
   ifconfig | grep "inet "
   ```

4. ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸:
   ```bash
   curl http://localhost:8080/health
   ```

### Web Dashboardì— ë°ì´í„°ê°€ ì•ˆ ë³´ì„

1. ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
2. ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ì—ëŸ¬ í™•ì¸ (F12)
3. ëª¨ë°”ì¼ì—ì„œ ë°ì´í„°ë¥¼ ì „ì†¡í–ˆëŠ”ì§€ í™•ì¸

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
lib/
â”œâ”€â”€ features/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ api_server.dart      # REST API ì„œë²„
â”‚   â”‚   â””â”€â”€ data_store.dart      # ì¸ë©”ëª¨ë¦¬ ë°ì´í„° ì €ì¥ì†Œ
â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â””â”€â”€ dashboard_screen.dart # ì›¹ ëŒ€ì‹œë³´ë“œ UI
â”‚   â””â”€â”€ detection/
â”‚       â””â”€â”€ time_tracker.dart     # ì‹œê°„ ì¶”ì  ì„œë¹„ìŠ¤
â”œâ”€â”€ screens/
â”‚   â””â”€â”€ camera_screen.dart        # ëª¨ë°”ì¼ ì¹´ë©”ë¼ í™”ë©´
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ api_service.dart          # API í†µì‹  ì„œë¹„ìŠ¤
â”‚   â””â”€â”€ camera_service.dart       # ì¹´ë©”ë¼ ì„œë¹„ìŠ¤
â”œâ”€â”€ shared/
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ stay_data.dart        # ë°ì´í„° ëª¨ë¸
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ logger.dart           # ë¡œê¹… ìœ í‹¸
â””â”€â”€ main.dart                     # ì•± ì§„ì…ì 

bin/
â””â”€â”€ server.dart                   # ì„œë²„ ì§„ì…ì 
```

---

## âœ… êµ¬í˜„ëœ ê¸°ëŠ¥

- [x] **Motion Detection**: í”½ì…€ ê¸°ë°˜ ëª¨ì…˜ ê°ì§€ (ML Kit ë¶ˆí•„ìš”)
- [x] **ìë™ ì½”ë„ˆ íŒì •**: ì›€ì§ì„ ê¸°ë°˜ ìë™ ì½”ë„ˆ ì¶”ì 
- [x] **ì‹¤ì‹œê°„ ì‹œê°í™”**: ì›¹ ëŒ€ì‹œë³´ë“œì—ì„œ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
- [x] **ìˆ˜ë™/ìë™ ëª¨ë“œ**: í…ŒìŠ¤íŠ¸ì™€ ì‹¤ì œ ì‚¬ìš© ê°„ ì „í™˜ ê°€ëŠ¥
- [x] **ê²½ëŸ‰í™”**: ì™¸ë¶€ ML ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜ì¡´ì„± ì œê±°

## ğŸ”® í–¥í›„ ê°œë°œ ì˜ˆì •

- [ ] **ë©€í‹° ì‚¬ëŒ ê°ì§€**: ì—¬ëŸ¬ ì‚¬ëŒ ë™ì‹œ ì¶”ì 
- [ ] **ë©€í‹° ë””ë°”ì´ìŠ¤ ì§€ì›**: ì—¬ëŸ¬ ì¹´ë©”ë¼ ë™ì‹œ ì‚¬ìš©
- [ ] **ë°ì´í„° ì˜ì†ì„±**: íŒŒì¼ ë˜ëŠ” DBì— ë°ì´í„° ì €ì¥
- [ ] **ê³ ê¸‰ ì‹œê°í™”**: ì°¨íŠ¸ ë° íˆíŠ¸ë§µ
- [ ] **ê°ì§€ ì •í™•ë„ í–¥ìƒ**: ë” ì •êµí•œ í¬ì¦ˆ ê°ì§€ ì•Œê³ ë¦¬ì¦˜

---

## ğŸ“Š API ì‚¬ì–‘

### POST /api/staytime

**Request:**
```json
{
  "device_id": "mobile_01",
  "corner_times": {
    "top-left": 20,
    "top-right": 15,
    "bottom-left": 0,
    "bottom-right": 10
  }
}
```

**Response:**
```json
{
  "status": "ok"
}
```

### GET /api/staytime

**Response:**
```json
{
  "mobile_01": {
    "top-left": 20,
    "top-right": 15,
    "bottom-left": 0,
    "bottom-right": 10
  }
}
```

---

Â© 2025 ì˜ˆìŠ¹ë‹˜ â€” ê°ì • ì”í–¥ ì „ì‹œ POC
