# 🔧 Troubleshooting Guide

## 현재 알려진 이슈

### 1. Google ML Kit Pose Detection 오류

**증상:**
```
E/ImageError: java.lang.IllegalArgumentException
E/ImageError: Getting Image failed
```

**원인:**
- Google ML Kit이 특정 안드로이드 디바이스의 카메라 이미지 포맷을 지원하지 않음
- CameraImage → InputImage 변환 시 호환성 문제

**해결 방법:**
앱을 **수동 모드**로 사용하세요:

1. 앱 시작 시 자동으로 **수동 모드**로 시작됨
2. 화면의 4개 구역을 직접 탭하여 시간 추적
3. 자동 감지가 필요하면 상단의 ✨ 버튼 클릭

---

## 사용 모드

### 🟠 수동 모드 (권장)
- **장점**: 안정적, 오류 없음, 모든 디바이스에서 작동
- **사용법**: 화면의 4개 구역 탭
- **용도**: 테스트, 시연, 안정적인 데이터 수집

### 🟢 자동 모드 (실험적)
- **장점**: 자동으로 사람 위치 추적
- **단점**: 일부 디바이스에서 오류 발생 가능
- **활성화**: 상단 ✨ 버튼 클릭
- **요구사항**:
  - Google Play Services 설치
  - ML Kit 지원 디바이스
  - 밝은 조명
  - 전신이 카메라에 보여야 함

---

## 전체 시스템 동작 확인

### ✅ 서버 실행 확인
```bash
dart run bin/server.dart
```

**정상 출력:**
```
✅ API Server running on http://0.0.0.0:8080
Available network addresses:
  - 100.114.49.33
```

**테스트:**
```bash
curl http://localhost:8080/health
```

### ✅ 웹 대시보드 확인
```bash
flutter run -d chrome
```

**확인 사항:**
- 브라우저에서 대시보드 열림
- "No data available" 또는 데이터 표시됨
- 콘솔에 오류 없음

### ✅ 모바일 앱 확인

**수동 모드 테스트:**
1. 앱 시작
2. 하단에 "MANUAL" (주황색) 표시 확인
3. 화면의 코너 탭 → 시간 누적 확인
4. 5초 후 웹 대시보드에서 데이터 확인

**자동 모드 테스트 (선택사항):**
1. 상단 ✨ 버튼 클릭
2. "AUTO" (초록색) 표시 확인
3. 카메라 앞에 서기
4. 초록색 원이 나타나면 감지 성공
5. 오류 발생 시 다시 ✨ 버튼으로 수동 모드 전환

---

## 데이터 흐름 확인

### 1. 모바일 → 서버
```bash
# 서버 터미널에서 확인
# POST 요청이 들어오면 로그 출력됨
```

### 2. 서버 → 웹 대시보드
```bash
# 웹 브라우저 콘솔(F12)에서 확인
# 2초마다 GET 요청
```

### 3. 수동으로 데이터 전송 테스트
```bash
# 모바일 앱에서 상단 📤 버튼 클릭
# 즉시 데이터 전송
```

---

## FAQ

### Q: 자동 감지가 안 되는데 어떻게 하나요?
A: 수동 모드를 사용하세요. 화면의 코너를 직접 탭하면 됩니다.

### Q: 웹 대시보드에 데이터가 안 보여요
A:
1. 서버가 실행 중인지 확인
2. 모바일 앱의 IP 주소가 `100.114.49.33`인지 확인
3. 같은 네트워크에 연결되어 있는지 확인

### Q: 앱이 느려요
A: 자동 모드를 끄고 수동 모드를 사용하세요.

---

## 성능 최적화

### 수동 모드 사용 권장
현재 버전에서는 수동 모드가 가장 안정적입니다:
- ✅ 오류 없음
- ✅ 빠른 응답
- ✅ 모든 디바이스 지원
- ✅ 정확한 데이터 수집

---

## 문의

문제가 계속되면:
1. `flutter clean && flutter pub get` 실행
2. 앱 재빌드
3. 서버 재시작
4. 같은 Wi-Fi 네트워크 연결 확인
